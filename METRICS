CREATE TABLE INTERVIEW_DB.PLAYGROUND_ANKITA_GOYAL.METRICS AS 
SELECT
CAST(DATE as date) as date,
DATE_TRUNC('WEEK',CAST(DATE as date)) AS WEEK,
DATE_TRUNC('MONTH',CAST(DATE as date)) AS MONTH,
DATE_TRUNC('YEAR',CAST(DATE as date)) AS YEAR,
LOCATION, 
TOTAL_CASES/REPLACE(POPULATION,0,1) AS INFECTED_PERC,
TOTAL_RECOVERED/REPLACE(TOTAL_CASES,0,1) AS RECOVERY_RATE, 
TOTAL_DEATHS/REPLACE(TOTAL_CASES,0,1) AS MORTALITY_RATE, 
NEW_CASES/REPLACE(TOTAL_CASES,0,1) AS DAILY_CONTRIBUTION_TOTAL_CASES,
NEW_DEATHS/REPLACE(TOTAL_DEATHS,0,1) AS DAILY_CONTRIBUTION_TOTAL_DEATHS,
GROWTH_FACTOR_OF_NEW_DEATHS,
GROWTH_FACTOR_OF_NEW_CASES,
NEW_CASES_PER_MILLION,
NEW_DEATHS_PER_MILLION,
CASE_RECOVERED_RATE
from FIVETRAN_INTERVIEW_DB.GOOGLE_SHEETS.COVID_19_INDONESIA_ankita_goyal
ORDER BY 1
